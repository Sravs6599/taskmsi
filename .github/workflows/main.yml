name: Install Firefox MSI

on: 
  push:
    branches:
      - main

jobs:
  install-msi:
    runs-on: self-hosted

    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Download Firefox MSI
      shell: pwsh
      run: |
        Invoke-WebRequest -Uri "https://www.exemsi.com/downloads/packages/Firefox/Firefox%20Setup%2014.0.1.msi" -OutFile "$env:LOCALAPPDATA\FirefoxSetup.msi"

    - name: Install Firefox MSI
      shell: pwsh
      run: |
        Start-Process msiexec.exe -ArgumentList '/i', "$env:LOCALAPPDATA\FirefoxSetup.msi", '/quiet', '/norestart' -NoNewWindow -Wait

    - name: Verify Installation
      shell: pwsh
      run: |
        if (Test-Path "C:\Program Files (x86)\Mozilla Firefox") {
          Write-Output "Installation Successful!"
        } else {
          throw "Installation failed!"
        }
